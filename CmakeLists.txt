cmake_minimum_required(VERSION 3.16)
project(authFirebaseCPP)

set(CMAKE_CXX_STANDARD 17)

# Suprimir aviso CMP0167 do FindBoost
cmake_policy(SET CMP0144 NEW)

# -------------------------------
# Paths do Firebase
# -------------------------------
set(FIREBASE_SDK_PATH "C:/Users/User/Documents/C++Libs/firebase_cpp_sdk")
set(FIREBASE_INCLUDE_DIR "${FIREBASE_SDK_PATH}/include")
set(FIREBASE_LIB_DIR "${FIREBASE_SDK_PATH}/libs/windows/VS2019/MD/x64/Release")

include_directories(${FIREBASE_INCLUDE_DIR})

link_directories(${FIREBASE_LIB_DIR})

# -------------------------------
# Paths do Boost
# -------------------------------
set(BOOST_ROOT "C:/Users/User/Documents/C++Libs/boost_1_88_0")
include_directories("${BOOST_ROOT}")

# -------------------------------
# Dotenv
# -------------------------------
find_package(laserpants_dotenv CONFIG REQUIRED
    PATHS "C:/Users/User/Documents/C++Libs/dotenv-cpp/lib/cmake/laserpants_dotenv"
)

# -------------------------------
# Executável
# -------------------------------
add_executable(authFirebaseCPP 
    main.cpp
    strategy/passwordMasked/passwordCinMasked.cpp
    strategy/convertstringToLower/convertStringToLower.cpp
    strategy/emailValidator/emailValidator.cpp
)

# -------------------------------
# Linkagem
# -------------------------------
target_link_libraries(authFirebaseCPP
    firebase_app
    firebase_auth
    laserpants::dotenv
    "C:/Users/User/Documents/C++Libs/boost_1_88_0/stage/lib/libboost_locale-vc143-mt-x64-1_88.lib"       # Link automático da DLL
    Ws2_32
    Crypt32
    Mswsock
    Userenv
)

# -------------------------------
# Copiar .env
# -------------------------------
add_custom_command(TARGET authFirebaseCPP POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
    "${CMAKE_SOURCE_DIR}/.env"
    $<TARGET_FILE_DIR:authFirebaseCPP>/.env
)